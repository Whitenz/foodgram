![Django-app workflow](https://github.com/Whitenz/foodgram-project-react/actions/workflows/foodgram_workflow.yml/badge.svg)

# [Foodgram](http://whitenz.ddns.net/) - сервис рецептов вкусных блюд

<details>
    <summary>для ревью</summary>
    login / password - review@yandex.ru / review
</details>


## Особенности
Проект Foodgram предназначен для публикации рецептов блюд с картинками. Позволяет пользователям подписываться на других
участников сайта, добавлять понравившиеся рецепты в избранное и корзину с последующим формированием списка покупок.

#### Технические особенности проекта:
- Проект выполнен в качестве Single-page application на JS-библиотеке React
- Бэкенд приложения разработан на Django
- Взаимодействие между фронтендтом и бэкендом осуществляется через Django rest framework
- В качестве СУБД используется PostgreSQL
- Веб-сервер - ngingx
- Проект разворачивается в docker контейнерах

## Описание проекта и функционала

### Главная страница

Содержимое главной страницы — список рецептов, отсортированных по дате публикации (от новых к старым).

### Страница рецепта

На странице — полное описание рецепта, возможность добавить рецепт в избранное и в список покупок, возможность подписаться на автора рецепта.

### Страница пользователя

На странице — имя пользователя, все рецепты, опубликованные пользователем и возможность подписаться на пользователя.

### Подписка на авторов

Подписка на публикации доступна только авторизованному пользователю. Страница подписок доступна только владельцу.

#### Сценарий поведения пользователя:

- Пользователь переходит на страницу другого пользователя или на страницу рецепта и подписывается на публикации автора кликом по кнопке `Подписаться на автора`.
- Пользователь переходит на страницу «Мои подписки» и просматривает список рецептов, опубликованных теми авторами, на которых он подписался. Сортировка записей — по дате публикации (от новых к старым).
- При необходимости пользователь может отказаться от подписки на автора: переходит на страницу автора или на страницу его рецепта и нажимает `Отписаться от автора`.

### Список избранного
Работа со списком избранного доступна **только авторизованному** пользователю. Список избранного может просматривать **только его владелец**.  

#### Сценарий поведения пользователя:

- Пользователь отмечает один или несколько рецептов кликом по кнопке `Добавить в избранное`.
- Пользователь переходит на страницу `Список избранного` и просматривает персональный список избранных рецептов.
- При необходимости пользователь может `Удалить` рецепт из избранного.

### Список покупок
Работа со списком покупок доступна **авторизованным и не авторизованным** пользователям. 
Список покупок может просматривать **только его владелец**.
**Сценарий поведения пользователя:**

- Пользователь отмечает один или несколько рецептов кликом по кнопке `Добавить в покупки`.
- Пользователь переходит на страницу `Список покупок`, там доступны все добавленные в список рецепты. Пользователь нажимает кнопку `Скачать` список и получает файл с суммированным перечнем и количеством необходимых ингредиентов для всех рецептов, сохранённых в `«Списке покупок»`.
- При необходимости пользователь может удалить рецепт из списка покупок.

Список покупок скачивается в формате `.txt`.
При скачивании списка покупок ингредиенты в результирующем суммируются.
### Фильтрация по тегам
При нажатии на название тега выводится список рецептов, отмеченных этим тегом. Фильтрация может проводиться по нескольким тегам в комбинации «или»: если выбраны несколько тегов — на странице будут показаны рецепты, которые отмечены хотя бы одним из этих тегов.
При фильтрации на странице пользователя фильтруются только рецепты выбранного пользователя. 
При фильтрации на странице избранного фильтруются только избранные рецепты. 


### Регистрация и авторизация
В проекте доступна система регистрации и авторизации пользователей. 
Обязательные поля для пользователя:
- Логин
- Пароль
- Email
- Имя
- Фамилия

### Что могут делать неавторизованные пользователи

- Создать аккаунт.
- Просматривать рецепты на главной.
- Просматривать отдельные страницы рецептов.
- Просматривать страницы пользователей.
- Фильтровать рецепты по тегам.
- Работать с персональным списком покупок: добавлять/удалять любые рецепты, выгружать файл с количеством необходимых ингредиентов для рецептов из списка покупок.

### Что могут делать авторизованные пользователи

- Входить в систему под своим логином и паролем.
- Выходить из системы (разлогиниваться).
- Восстанавливать свой пароль.
- Менять свой пароль.
- Создавать/редактировать/удалять собственные рецепты
- Просматривать рецепты на главной.
- Просматривать страницы пользователей.
- Просматривать отдельные страницы рецептов.
- Фильтровать рецепты по тегам.
- Работать с персональным списком избранного: добавлять/удалять чужие рецепты, просматривать свою страницу избранных рецептов.
- Работать с персональным списком покупок: добавлять/удалять любые рецепты, выгружать файл с количеством необходимых ингредиентов для рецептов из списка покупок.
- Подписываться на публикации авторов рецептов и отменять подписку, просматривать свою страницу подписок.

### Что может делать администратор
Администратор обладает всеми правами авторизованного пользователя.
Плюс к этому он может:
- изменять пароль любого пользователя,
- создавать/блокировать/удалять аккаунты пользователей,
- редактировать/удалять любые рецепты,
- добавлять/удалять/редактировать ингредиенты.
- добавлять/удалять/редактировать теги.

## Как запустить приложение

#### Запустить командную строку:
<details>
    <summary>Windows</summary>
    Скачайте и установите Git Bash. Подробная инструкция и дистрибутив можно найти на <a href="https://gitforwindows.org/">сайте</a>. Затем в меню пуск найдите и запустите приложение Git Bash.
</details>
<details>
    <summary>macOS или Linux</summary>
    Откройте главное меню приложений и выберите приложение "Терминал".
</details>

#### Установить Docker:

Следуйте официальной [документации](https://docs.docker.com/get-docker/) Docker для Вашей ОС.


#### Клонировать репозиторий и перейти в каталог с файлом docker-compose.yaml:
```
git clone https://github.com/Whitenz/foodgram-project-react.git && cd foodgram-project-react/infra/
```

#### Создать файл .env с переменными окружения:
```
touch .env &&
echo SECRET_KEY=YOUR_SECRET_KEY > .env &&
echo DB_ENGINE=django.db.backends.postgresql >> .env &&
echo DB_NAME=postgres >> .env &&
echo POSTGRES_USER=postgres >> .env &&
echo POSTGRES_PASSWORD=postgres >> .env &&
echo DB_HOST=db >> .env &&
echo DB_PORT=5432 >> .env
```

#### Создать образы и запустить контейнеры:
```
sudo docker-compose up -d
```

#### Выполнить миграции:
```
sudo docker-compose exec backend python manage.py migrate
```

#### Собрать статику:
```
sudo docker-compose exec backend python manage.py collectstatic --no-input
```

#### Создать суперпользователя:
```
sudo docker-compose exec backend python manage.py createsuperuser

```

#### Заполнить базу данных ингредиентами для рецептов:
```
sudo docker-compose exec backend python manage.py populate_db

```

#### Создать необходимые теги для рецептов через admin зону
```
http://localhost/admin/
```

## Эндпоинты API
- Пользователи
```
/api/users/ - GET, POST
/api/users/{id}/ - GET
/api/users/me/ - GET
/api/users/set_password/ - POST
/api/auth/token/login/ - POST
/api/auth/token/logout/ - POST
```
- Теги
```
/api/tags/- GET
/api/tags/{id}/ - GET
```
- Рецепты
```
/api/recipes/ - GET, POST
/api/recipes/{id}/ - GET, PATCH, DEL
```
- Список покупок
```
/api/recipes/download_shopping_cart/ - GET
/api/recipes/{id}/shopping_cart/ - POST, DEL
```
- Избранное
```
/api/recipes/{id}/favorite/ - POST, DEL
```
- Подписки
```
/api/users/subscriptions/ - GET
/api/users/{id}/subscribe/ - POST, DEL
```
- Ингредиенты
```
/api/ingredients/ - GET
/api/ingredients/{id}/ - GET
```

Подробная документаци по API доступна после запуска проекта - http://localhost/api/docs/


✨ Поздравляю ✨ <br>
Приложение запущено и готово к работе.

### Пример запроса к API

Информация о рецепте
```
curl -X GET 'http://localhost/api/recipes/1/'
```
Ответ
```
{
 "id": 1,
 "tags": [
  {
   "id": 1,
   "name": "завтрак",
   "color": "#dbab27",
   "slug": "breakfast"
  }
 ],
 "author": {
  "username": "veronika",
  "first_name": "Вероника",
  "last_name": "Петухова",
  "id": 4,
  "email": "veronika@ya.ru",
  "is_subscribed": false
 },
 "ingredients": [
  {
   "id": 2182,
   "name": "яйца куриные",
   "measurement_unit": "г",
   "amount": 200
  },
  {
   "id": 1342,
   "name": "помидоры",
   "measurement_unit": "г",
   "amount": 100
  },
  {
   "id": 1685,
   "name": "соль",
   "measurement_unit": "г",
   "amount": 15
  }
 ],
 "is_favorited": false,
 "is_in_shopping_cart": false,
 "name": "яичница с помидором",
 "image": "http://whitenz.ddns.net/media/recipes/images/veronika_recipe.jpeg",
 "text": "простой рецепт яичницы с помидором",
 "cooking_time": 10
}
```

## Стек технологий
- Django
- React
- djoser
- postgresql
- nginx
- gunicorn
- docker


## Лицензия
BSD 3-Clause License


## Автор
Ilya Kolesnikov